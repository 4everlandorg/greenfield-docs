"use strict";(self.webpackChunkgreenfield_docs=self.webpackChunkgreenfield_docs||[]).push([[1614],{3905:(e,r,t)=>{t.d(r,{Zo:()=>l,kt:()=>f});var o=t(67294);function i(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function a(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function n(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?a(Object(t),!0).forEach((function(r){i(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function c(e,r){if(null==e)return{};var t,o,i=function(e,r){if(null==e)return{};var t,o,i={},a=Object.keys(e);for(o=0;o<a.length;o++)t=a[o],r.indexOf(t)>=0||(i[t]=e[t]);return i}(e,r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)t=a[o],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var s=o.createContext({}),d=function(e){var r=o.useContext(s),t=r;return e&&(t="function"==typeof e?e(r):n(n({},r),e)),t},l=function(e){var r=d(e.components);return o.createElement(s.Provider,{value:r},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var r=e.children;return o.createElement(o.Fragment,{},r)}},m=o.forwardRef((function(e,r){var t=e.components,i=e.mdxType,a=e.originalType,s=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),p=d(t),m=i,f=p["".concat(s,".").concat(m)]||p[m]||u[m]||a;return t?o.createElement(f,n(n({ref:r},l),{},{components:t})):o.createElement(f,n({ref:r},l))}));function f(e,r){var t=arguments,i=r&&r.mdxType;if("string"==typeof e||i){var a=t.length,n=new Array(a);n[0]=m;var c={};for(var s in r)hasOwnProperty.call(r,s)&&(c[s]=r[s]);c.originalType=e,c[p]="string"==typeof e?e:i,n[1]=c;for(var d=2;d<a;d++)n[d]=t[d];return o.createElement.apply(null,n)}return o.createElement.apply(null,t)}m.displayName="MDXCreateElement"},57050:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>s,contentTitle:()=>n,default:()=>u,frontMatter:()=>a,metadata:()=>c,toc:()=>d});var o=t(87462),i=(t(67294),t(3905));const a={title:"Receiver"},n="Receiver",c={unversionedId:"guide/storage-provider/modules/receiver",id:"guide/storage-provider/modules/receiver",title:"Receiver",description:"Receiver is responsible for accepting piece data that replicated from primary SP. When receiving piece data from primary SP, piece data is transferred from Gateway and then use gRPC to receiver module.",source:"@site/docs/guide/storage-provider/modules/receiver.md",sourceDirName:"guide/storage-provider/modules",slug:"/guide/storage-provider/modules/receiver",permalink:"/greenfield-docs/docs/guide/storage-provider/modules/receiver",draft:!1,editUrl:"https://github.com/bnb-chain/greenfield-docs/blob/main/docs/guide/storage-provider/modules/receiver.md",tags:[],version:"current",frontMatter:{title:"Receiver"},sidebar:"guideSidebar",previous:{title:"TaskExecutor",permalink:"/greenfield-docs/docs/guide/storage-provider/modules/taskexecutor"},next:{title:"Metadata",permalink:"/greenfield-docs/docs/guide/storage-provider/modules/metadata"}},s={},d=[{value:"ReceivePieceTask",id:"receivepiecetask",level:2},{value:"GfSp Framework Receiver Code",id:"gfsp-framework-receiver-code",level:2}],l={toc:d},p="wrapper";function u(e){let{components:r,...t}=e;return(0,i.kt)(p,(0,o.Z)({},l,t,{components:r,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"receiver"},"Receiver"),(0,i.kt)("p",null,"Receiver is responsible for accepting piece data that replicated from primary SP. When receiving piece data from primary SP, piece data is transferred from Gateway and then use gRPC to receiver module."),(0,i.kt)("p",null,"Receiver is an abstract interface to receive the piece data from primary SP."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-go"},"type Receiver interface {\n    Modular\n    // HandleReceivePieceTask stores piece data into secondary SP.\n    HandleReceivePieceTask(ctx context.Context, task task.ReceivePieceTask, data []byte) error\n    // HandleDoneReceivePieceTask calculates the secondary bls signature of the object and sign it, returns to the primary\n    // SP for sealed object.\n    HandleDoneReceivePieceTask(ctx context.Context, task task.ReceivePieceTask) ([]byte, error)\n    // QueryTasks queries replicate piece tasks that running on receiver by task sub-key.\n    QueryTasks(ctx context.Context, subKey task.TKey) ([]task.Task, error)\n}\n")),(0,i.kt)("p",null,"Receiver interface inherits ",(0,i.kt)("a",{parentName:"p",href:"/greenfield-docs/docs/guide/storage-provider/modules/common/lifecycle_modular#modular-interface"},"Modular interface"),", so Receiver module can be managed by lifecycle and resource manager."),(0,i.kt)("p",null,"In terms of the functions provided by Receiver module, there is only one part: receive piece data. There are three methods in Receiver interface. Therefore, you can rewrite these methods to meet your own requirements."),(0,i.kt)("p",null,"As we can see from the second parameter of the methods defined in ",(0,i.kt)("inlineCode",{parentName:"p"},"Receiver")," interface, ReceivePiece is split into ",(0,i.kt)("inlineCode",{parentName:"p"},"ReceivePieceTask"),". They are also defined as an interface."),(0,i.kt)("p",null,"We can query ReceivePiece tasks that we care about by ",(0,i.kt)("inlineCode",{parentName:"p"},"QueryTasks")," method through using subKey."),(0,i.kt)("h2",{id:"receivepiecetask"},"ReceivePieceTask"),(0,i.kt)("p",null,"The corresponding interfaces definition is shown below:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/greenfield-docs/docs/guide/storage-provider/modules/common/task#receivepiecetask"},"ReceivePieceTask")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/greenfield-docs/docs/guide/storage-provider/modules/common/task#objecttask"},"ObjectTask"))),(0,i.kt)("p",null,"ObjectTask inherits ",(0,i.kt)("a",{parentName:"p",href:"/greenfield-docs/docs/guide/storage-provider/modules/common/task#task"},"Task interface"),". ReceivePieceTask also defines 14 methods to help query info or set data. You can overwrite all these methods in your own."),(0,i.kt)("p",null,"The corresponding ",(0,i.kt)("inlineCode",{parentName:"p"},"protobuf")," definition is shown below:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/greenfield-docs/docs/guide/storage-provider/modules/common/proto#gfspreceivepiecetask-proto"},"GfSpReceivePieceTask")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/greenfield-docs/docs/guide/storage-provider/modules/common/proto#objectinfo-proto"},"ObjectInfo")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/greenfield-docs/docs/guide/storage-provider/modules/common/proto#params-proto"},"Params"))),(0,i.kt)("h2",{id:"gfsp-framework-receiver-code"},"GfSp Framework Receiver Code"),(0,i.kt)("p",null,"Receiver module code implementation: ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/bnb-chain/greenfield-storage-provider/tree/master/modular/receiver"},"Receiver")))}u.isMDXComponent=!0}}]);