"use strict";(self.webpackChunkgreenfield_docs=self.webpackChunkgreenfield_docs||[]).push([[2821],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var d=a.createContext({}),l=function(e){var t=a.useContext(d),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},c=function(e){var t=l(e.components);return a.createElement(d.Provider,{value:t},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,d=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),p=l(n),m=r,h=p["".concat(d,".").concat(m)]||p[m]||u[m]||o;return n?a.createElement(h,s(s({ref:t},c),{},{components:n})):a.createElement(h,s({ref:t},c))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,s=new Array(o);s[0]=m;var i={};for(var d in t)hasOwnProperty.call(t,d)&&(i[d]=t[d]);i.originalType=e,i[p]="string"==typeof e?e:r,s[1]=i;for(var l=2;l<o;l++)s[l]=n[l];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},37389:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>s,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>l});var a=n(87462),r=(n(67294),n(3905));const o={},s="Redundancy",i={unversionedId:"guide/storage-provider/modules/redundancy",id:"guide/storage-provider/modules/redundancy",title:"Redundancy",description:"Strategy Design",source:"@site/docs/guide/storage-provider/modules/redundancy.md",sourceDirName:"guide/storage-provider/modules",slug:"/guide/storage-provider/modules/redundancy",permalink:"/greenfield-docs/docs/guide/storage-provider/modules/redundancy",draft:!1,editUrl:"https://github.com/bnb-chain/greenfield-docs/blob/main/docs/guide/storage-provider/modules/redundancy.md",tags:[],version:"current",frontMatter:{},sidebar:"guideSidebar",previous:{title:"Piece Store",permalink:"/greenfield-docs/docs/guide/storage-provider/modules/piece-store"},next:{title:"BSDB",permalink:"/greenfield-docs/docs/guide/storage-provider/modules/bsdb"}},d={},l=[{value:"Strategy Design",id:"strategy-design",level:2},{value:"Segments",id:"segments",level:2},{value:"Erasure Code and Data Redundancy",id:"erasure-code-and-data-redundancy",level:2}],c={toc:l},p="wrapper";function u(e){let{components:t,...o}=e;return(0,r.kt)(p,(0,a.Z)({},c,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"redundancy"},"Redundancy"),(0,r.kt)("h2",{id:"strategy-design"},"Strategy Design"),(0,r.kt)("p",null,"It is assumed that each SP provides more stable service and won\u2019t go offline as enough BNB are staking to be one SP in Greenfield. But as there are a few SPs distributed all over the world in Greenfield, Greenfield still needs to have its own redundancy strategy in case some SP goes offline for some unexpected reasons.\xa0\nConsidering the data locality, people can get better storage service from the SPs in the same region. So Greenfield provides below redundancy strategy:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Replica and EC are used in the Greenfield network; Default EC is 4+2, 4 data chunks and 2 parity chunks.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"All segments of each object are stored in primary SP as pieces which can be regarded as one replica of the object.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"All EC chunks of each object are stored in some secondary SPs as pieces, which can be regarded as one EC replica of the object.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"EC chunks are stored in secondary SPs with fixed rules."))),(0,r.kt)("h2",{id:"segments"},"Segments"),(0,r.kt)("p",null,"Segment is the basic storage structure of an object. An object payload is composed of one or many segments in sequence. The default segment size is 16MB. If the object's size is less than 16MB, it has only one segment and the segment size is the same as the object's size. For larger objects, the payload data will be broken into segments."),(0,r.kt)("p",null,"Please note the payload data of an object will be split into the same size segment but the last segment, which is the actual size. For example, if one object has a size 50MB, only the size of the last segment is 2 MB and the other segments' sizes are all 16MB."),(0,r.kt)("h2",{id:"erasure-code-and-data-redundancy"},"Erasure Code and Data Redundancy"),(0,r.kt)("p",null,"Although each SP may provide a more stable service and won't go offline as enough BNB are staking to be one SP, Greenfield still establish its own redundancy strategy to get rid of the dependency on a single SP and support the data availability in a decentralized way. Here below is the basic design idea."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'all segments of each object are stored in primary SP as "pieces", which can be regarded as one replica of the object. Users may download this data directly from the primary SP as it is supposed to provide the full data in a low latency way.')),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Erasure Code (EC) is introduced to get efficient data redundancy. Segment is the boundary to perform erasure encoding. By erasure encoding one segment at a time, it allows streaming the processing of the object upload without waiting for the whole object payload to finish. The default EC strategy is 4+2, 4 data chunks, and 2 parity chunks for one segment. The data chunk size is \xbc of the segment. As one typical segment is 16M, one typical data chunk of EC is 4M. Specialized customization on EC parameters for each user may be provided via special transactions."))),(0,r.kt)("p",null,"All EC chunks of each object are stored in some secondary SPs as pieces, which can be regarded as more than one EC replica of the object. If one or more segments of the object are lost from the primary SP, any 4 chunks from 6 SPs can recover the segments."),(0,r.kt)("p",null,"All these segments and SPs information are stored on the Greenfield blockchain as the metadata of the object. The same object's each segment's EC replicas are stored in the same sequence of secondary SPs. This convention is to save the metadata size. An example of a 50M object stored with one primary SP, SP0, and 6 secondary SPs, SP1-SP6 is shown in the below diagram."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"ec-flow",src:n(45563).Z,width:"1300",height:"614"})),(0,r.kt)("div",{style:{textAlign:"center"}},(0,r.kt)("i",null,"EC for Segments in Different Secondary SPs")),(0,r.kt)("p",null,"Below is how the key of each piece is defined:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"The key is ",(0,r.kt)("inlineCode",{parentName:"p"},'"sobjectID"+"ssegIndex"')," for each segment piece, such as ",(0,r.kt)("inlineCode",{parentName:"p"},"sobjectID_s0"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"The key is ",(0,r.kt)("inlineCode",{parentName:"p"},'"eobjectID"+"ssegIndex"+"pSPIndex"')," for each groups after EC, such as ",(0,r.kt)("inlineCode",{parentName:"p"},"eobjectID_s0_p0"),"."))),(0,r.kt)("p",null,"The same column data will be stored into same SP."))}u.isMDXComponent=!0},45563:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/10-SP-EC-a6d9a06707fe1498ae2406b1cf065e73.jpg"}}]);