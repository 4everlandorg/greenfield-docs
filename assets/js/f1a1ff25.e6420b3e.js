"use strict";(self.webpackChunkgreenfield_docs=self.webpackChunkgreenfield_docs||[]).push([[4233],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>f});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,s=e.originalType,l=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),p=c(n),m=r,f=p["".concat(l,".").concat(m)]||p[m]||u[m]||s;return n?a.createElement(f,i(i({ref:t},d),{},{components:n})):a.createElement(f,i({ref:t},d))}));function f(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var s=n.length,i=new Array(s);i[0]=m;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o[p]="string"==typeof e?e:r,i[1]=o;for(var c=2;c<s;c++)i[c]=n[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},57757:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>s,metadata:()=>o,toc:()=>c});var a=n(87462),r=(n(67294),n(3905));const s={title:"Javascript SDK"},i="Quickstart",o={unversionedId:"sdks/sdk-js",id:"sdks/sdk-js",title:"Javascript SDK",description:"The BNB Greenfield JavaScript SDK is designed for front-end environments and provides an API for interacting with BNB Greenfield decentralized storage. It offers a range of operations, including retrieving permission details, gas fees, etc. The SDK also includes a crypto component for signing transactions and sending them to BNB Greenfield.",source:"@site/docs/sdks/sdk-js.md",sourceDirName:"sdks",slug:"/sdks/sdk-js",permalink:"/greenfield-docs/docs/sdks/sdk-js",draft:!1,editUrl:"https://github.com/bnb-chain/greenfield-docs/blob/main/docs/sdks/sdk-js.md",tags:[],version:"current",frontMatter:{title:"Javascript SDK"},sidebar:"apiReferenceSidebar",previous:{title:"Go SDK",permalink:"/greenfield-docs/docs/sdks/sdk-go"}},l={},c=[{value:"Install",id:"install",level:2},{value:"Usage",id:"usage",level:2},{value:"Create client",id:"create-client",level:3},{value:"Transactions",id:"transactions",level:3},{value:"1. Transaction construction",id:"1-transaction-construction",level:4},{value:"2. Simulate Transactions",id:"2-simulate-transactions",level:4},{value:"3. Broadcast Transactions",id:"3-broadcast-transactions",level:4},{value:"4. Multi-Transactions",id:"4-multi-transactions",level:4},{value:"Querying Metadata",id:"querying-metadata",level:3},{value:"Storage Providers",id:"storage-providers",level:3},{value:"1. List Storage Providers",id:"1-list-storage-providers",level:4},{value:"2. Search for objects",id:"2-search-for-objects",level:4},{value:"Code Repository SDK",id:"code-repository-sdk",level:2}],d={toc:c},p="wrapper";function u(e){let{components:t,...n}=e;return(0,r.kt)(p,(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"quickstart"},"Quickstart"),(0,r.kt)("p",null,"The BNB Greenfield JavaScript SDK is designed for front-end environments and provides an API for interacting with BNB Greenfield decentralized storage. It offers a range of operations, including retrieving permission details, gas fees, etc. The SDK also includes a crypto component for signing transactions and sending them to BNB Greenfield."),(0,r.kt)("p",null,"However, it should be noted that this SDK does not include methods for interacting with BNB Smart Chain (BSC). For a comprehensive understanding of available operations, refer to the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/bnb-chain/greenfield-js-sdk"},"API Reference"),"."),(0,r.kt)("h2",{id:"install"},"Install"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"# QA\nnpm install @bnb-chain/greenfield-chain-sdk@alpha\n\n# TESTNET\nnpm install @bnb-chain/greenfield-chain-sdk@beta\n")),(0,r.kt)("h2",{id:"usage"},"Usage"),(0,r.kt)("p",null,"To utilize the SDK functionality, users need to instantiate a client object from the SDK. This client object serves as the interface to interact with BNB Greenfield and perform the desired operations."),(0,r.kt)("h3",{id:"create-client"},"Create client"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"import {Client} from '@bnb-chain/greenfield-chain-sdk'\nconst client = Client.create(GRPC_URL, GREEN_CHAIN_ID);\n")),(0,r.kt)("p",null,"The SDK offers two types of operations - sending transactions to BNB Greenfield, allowing users to modify the state of the blockchain; the second type enables users to send queries and retrieve metadata information about objects stored on the blockchain. "),(0,r.kt)("h3",{id:"transactions"},"Transactions"),(0,r.kt)("h4",{id:"1-transaction-construction"},"1. Transaction construction"),(0,r.kt)("p",null,"The SDK offers functionality for transferring tokens between accounts, providing a straightforward and convenient way to perform token transfers. With the SDK, users can easily initiate and execute token transfers within the desired accounts, streamlining the process of managing and exchanging tokens."),(0,r.kt)("p",null,"The SDK includes functionality for simulating and broadcasting transactions, allowing users to retrieve essential information related to gas fees, and sending the transaction over network."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const { simulate, broadcast } = await client.account.transfer({\n  fromAddress: address,\n  toAddress: transferInfo.to,\n  amount: [\n    {\n      denom: 'BNB',\n      amount: ethers.utils.parseEther(transferInfo.amount).toString(),\n    },\n  ],\n});\n")),(0,r.kt)("h4",{id:"2-simulate-transactions"},"2. Simulate Transactions"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// simulate tx\nconst simulateInfo = await simulate({\n    denom: 'BNB',\n});\n\n// This includes details such as gas limit, gas price, and overall gas fee.\n")),(0,r.kt)("h4",{id:"3-broadcast-transactions"},"3. Broadcast Transactions"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// broadcast tx\nconst broadcastRes = await broadcast({\n  denom: 'BNB',\n  gasLimit: Number(simulateInfo.gasLimit),\n  gasPrice: simulateInfo.gasPrice,\n  payer: address,\n  granter: '',\n});\n")),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"broadcast")," use ",(0,r.kt)("inlineCode",{parentName:"p"},"window.ethereum")," as signature provider by default."),(0,r.kt)("p",null,"If you want to use others, you can set ",(0,r.kt)("inlineCode",{parentName:"p"},"signTypedDataCallback"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// TrustWallet\nconst broadcastRes = await broadcast({\n  //...\n  signTypedDataCallback: async (addr: string, message: string) => {\n    return await window.trustwallet.request({\n      method: 'eth_signTypedData_v4',\n      params: [addr, message],\n    });\n  }\n});\n")),(0,r.kt)("p",null,"For the Nodejs environment, you can set ",(0,r.kt)("inlineCode",{parentName:"p"},"privateKey")," with the private key:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const broadcastRes = await broadcast({\n  //...\n  privateKey: '0x.......'\n});\n")),(0,r.kt)("h4",{id:"4-multi-transactions"},"4. Multi-Transactions"),(0,r.kt)("p",null,"The SDK also provides support for bundling multiple operations into a single transaction, thereby reducing gas fees. This feature allows users to optimize their transactions by combining several operations together, minimizing the overall gas cost associated with executing them individually. By leveraging this functionality, users can effectively manage their gas fees and enhance the efficiency of their transactions within the blockchain network using the SDK."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const createGroupTx = await client.group.createGroup(params);\nconst mirrorGroupTx = await client.crosschain.mirrorGroup({\n    groupName,\n    id,\n    operator,\n  });\n\nconst principal = {\n          type: PermissionTypes.PrincipalType.PRINCIPAL_TYPE_GNFD_GROUP,\n          value: GRNToString(newGroupGRN(address as string, groupName)),\n        };\n\nconst statement: PermissionTypes.Statement = {\n          effect: PermissionTypes.Effect.EFFECT_ALLOW,\n          actions: [PermissionTypes.ActionType.ACTION_GET_OBJECT],\n          resources: [\n            GRNToString(\n              type === 'Data'\n                ? newObjectGRN(bucketName, name)\n                : newObjectGRN(bucketName, '*'),\n            ),\n          ],\n        };\n\nconst policyTx = await client.object.putObjectPolicy(bucketName, name, {\n            operator: address,\n            statements: [statement],\n            principal,\n          });\n\nconst { simulate, broadcast } = await multiTx([\n          createGroupTx,\n          mirrorGroupTx,\n          policyTx,\n        ]);\n")),(0,r.kt)("h3",{id:"querying-metadata"},"Querying Metadata"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"// get account info\nawait client.account.getAccount(address);\n")),(0,r.kt)("h3",{id:"storage-providers"},"Storage Providers"),(0,r.kt)("p",null,"In addition, the SDK provides support for querying the list of storage providers available and offers generic search capabilities for exploring metadata attributes."),(0,r.kt)("h4",{id:"1-list-storage-providers"},"1. List Storage Providers"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"export const getSps = async () => {\n  const sps = await client.sp.getStorageProviders();\n  const finalSps = (sps ?? []).filter(\n    (v: any) => v?.description?.moniker !== 'QATest',\n  );\n\n  return finalSps;\n};\n")),(0,r.kt)("h4",{id:"2-search-for-objects"},"2. Search for objects"),(0,r.kt)("p",null,"It's important to note that even if an object is set to private, its metadata remains publicly accessible. This metadata includes information such as file size, file type, and file name. "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"export const searchKey = async (key: string) => {\n  try {\n    return await client.sp.listGroup(key, `${DAPP_NAME}_`, {\n      sourceType: 'SOURCE_TYPE_ORIGIN',\n      limit: 1000,\n      offset: 0,\n    });\n  } catch (e) {\n    return [];\n}\n")),(0,r.kt)("h2",{id:"code-repository-sdk"},"Code Repository SDK"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://github.com/bnb-chain/greenfield-js-sdk"},"Official JS implementation SDK"))))}u.isMDXComponent=!0}}]);