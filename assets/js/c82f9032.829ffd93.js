"use strict";(self.webpackChunkgreenfield_docs=self.webpackChunkgreenfield_docs||[]).push([[5093],{55145:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>p,contentTitle:()=>l,default:()=>u,frontMatter:()=>i,metadata:()=>r,toc:()=>d});var a=o(87462),t=(o(67294),o(3905));const i={title:"SP Config",order:6},l="SP Config",r={unversionedId:"guide/storage-provider/run-book/config",id:"guide/storage-provider/run-book/config",title:"SP Config",description:"This section gives you a complete config of SP. ./gnfd-sp config.dump will generate a template for you.",source:"@site/docs/guide/storage-provider/run-book/config.md",sourceDirName:"guide/storage-provider/run-book",slug:"/guide/storage-provider/run-book/config",permalink:"/greenfield-docs/docs/guide/storage-provider/run-book/config",draft:!1,editUrl:"https://github.com/bnb-chain/greenfield-docs/blob/main/docs/guide/storage-provider/run-book/config.md",tags:[],version:"current",frontMatter:{title:"SP Config",order:6},sidebar:"guideSidebar",previous:{title:"How to deploy Piece Store",permalink:"/greenfield-docs/docs/guide/storage-provider/run-book/piece-store"},next:{title:"SP Common Issues",permalink:"/greenfield-docs/docs/guide/storage-provider/run-book/common-issues"}},p={},d=[{value:"App info",id:"app-info",level:2},{value:"Database",id:"database",level:2},{value:"PieceStore",id:"piecestore",level:2},{value:"Chain info",id:"chain-info",level:2},{value:"SpAccount",id:"spaccount",level:2},{value:"Endpoint",id:"endpoint",level:2},{value:"P2P",id:"p2p",level:2},{value:"Gateway",id:"gateway",level:2},{value:"BlockSyncer",id:"blocksyncer",level:2}],s={toc:d},c="wrapper";function u(e){let{components:n,...o}=e;return(0,t.kt)(c,(0,a.Z)({},s,o,{components:n,mdxType:"MDXLayout"}),(0,t.kt)("h1",{id:"sp-config"},"SP Config"),(0,t.kt)("p",null,"This section gives you a complete config of SP. ",(0,t.kt)("inlineCode",{parentName:"p"},"./gnfd-sp config.dump")," will generate a template for you."),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-toml"},"# optional\nEnv = ''\n# optional\nAppID = ''\n# optional\nServer = []\n# optional\nGRPCAddress = ''\n\n[SpDB]\n# required\nUser = ''\n# required\nPasswd = ''\n# required\nAddress = ''\n# required\nDatabase = ''\n# optional\nConnMaxLifetime = 0\n# optional\nConnMaxIdleTime = 0\n# optional\nMaxIdleConns = 0\n# optional\nMaxOpenConns = 0\n\n[BsDB]\n# required\nUser = ''\n# required\nPasswd = ''\n# required\nAddress = ''\n# required\nDatabase = ''\n# optional\nConnMaxLifetime = 0\n# optional\nConnMaxIdleTime = 0\n# optional\nMaxIdleConns = 0\n# optional\nMaxOpenConns = 0\n\n[BsDBBackup]\n# required\nUser = ''\n# required\nPasswd = ''\n# required\nAddress = ''\n# required\nDatabase = ''\n# optional\nConnMaxLifetime = 0\n# optional\nConnMaxIdleTime = 0\n# optional\nMaxIdleConns = 0\n# optional\nMaxOpenConns = 0\n\n[PieceStore]\n# required\nShards = 0\n\n[PieceStore.Store]\n# required\nStorage = ''\n# optional\nBucketURL = ''\n# optional\nMaxRetries = 0\n# optional\nMinRetryDelay = 0\n# optional\nTLSInsecureSkipVerify = false\n# required\nIAMType = ''\n\n[Chain]\n# required\nChainID = ''\n# required\nChainAddress = []\n# optional\nSealGasLimit = 0\n# optional\nSealFeeAmount = 0\n# optional\nRejectSealGasLimit = 0\n# optional\nRejectSealFeeAmount = 0\n# optional\nDiscontinueBucketGasLimit = 0\n# optional\nDiscontinueBucketFeeAmount = 0\n# optional\nCreateGlobalVirtualGroupGasLimit = 0\n# optional\nCreateGlobalVirtualGroupFeeAmount = 0\n# optional\nCompleteMigrateBucketGasLimit = 0\n# optional\nCompleteMigrateBucketFeeAmount = 0\n\n[SpAccount]\n# required\nSpOperatorAddress = ''\n# required\nOperatorPrivateKey = ''\n# required\nFundingPrivateKey = ''\n# required\nSealPrivateKey = ''\n# required\nApprovalPrivateKey = ''\n# required\nGcPrivateKey = ''\n# required\nBlsPrivateKey = ''\n\n[Endpoint]\n# required\nApproverEndpoint = ''\n# required\nManagerEndpoint = ''\n# required\nDownloaderEndpoint = ''\n# required\nReceiverEndpoint = ''\n# required\nMetadataEndpoint = ''\n# required\nUploaderEndpoint = ''\n# required\nP2PEndpoint = ''\n# required\nSignerEndpoint = ''\n# required\nAuthenticatorEndpoint = ''\n\n[Approval]\n# optional\nBucketApprovalTimeoutHeight = 0\n# optional\nObjectApprovalTimeoutHeight = 0\n# optional\nReplicatePieceTimeoutHeight = 0\n\n[Bucket]\n# optional\nAccountBucketNumber = 0\n# optional\nFreeQuotaPerBucket = 0\n# optional\nMaxListReadQuotaNumber = 0\n# optional\nMaxPayloadSize = 0\n\n[Gateway]\n# required\nDomainName = ''\n# required\nHTTPAddress = ''\n\n[Executor]\n# optional\nMaxExecuteNumber = 0\n# optional\nAskTaskInterval = 0\n# optional\nAskReplicateApprovalTimeout = 0\n# optional\nAskReplicateApprovalExFactor = 0.0\n# optional\nListenSealTimeoutHeight = 0\n# optional\nListenSealRetryTimeout = 0\n# optional\nMaxListenSealRetry = 0\n\n[P2P]\n# required\nP2PPrivateKey = ''\n# required\nP2PAddress = ''\n# required\nP2PAntAddress = ''\n# required\nP2PBootstrap = []\n# optional\nP2PPingPeriod = 0\n\n[Parallel]\n# optional\nGlobalCreateBucketApprovalParallel = 0\n# optional\nGlobalCreateObjectApprovalParallel = 0\n# optional\nGlobalMaxUploadingParallel = 0\n# optional\nGlobalUploadObjectParallel = 0\n# optional\nGlobalReplicatePieceParallel = 0\n# optional\nGlobalSealObjectParallel = 0\n# optional\nGlobalReceiveObjectParallel = 0\n# optional\nGlobalGCObjectParallel = 0\n# optional\nGlobalGCZombieParallel = 0\n# optional\nGlobalGCMetaParallel = 0\n# optional\nGlobalRecoveryPieceParallel = 0\n# optional\nGlobalMigrateGVGParallel = 0\n# optional\nGlobalBackupTaskParallel = 0\n# optional\nGlobalDownloadObjectTaskCacheSize = 0\n# optional\nGlobalChallengePieceTaskCacheSize = 0\n# optional\nGlobalBatchGcObjectTimeInterval = 0\n# optional\nGlobalGcObjectBlockInterval = 0\n# optional\nGlobalGcObjectSafeBlockDistance = 0\n# optional\nGlobalSyncConsensusInfoInterval = 0\n# optional\nUploadObjectParallelPerNode = 0\n# optional\nReceivePieceParallelPerNode = 0\n# optional\nDownloadObjectParallelPerNode = 0\n# optional\nChallengePieceParallelPerNode = 0\n# optional\nAskReplicateApprovalParallelPerNode = 0\n# optional\nQuerySPParallelPerNode = 0\n# required\nDiscontinueBucketEnabled = false\n# optional\nDiscontinueBucketTimeInterval = 0\n# required\nDiscontinueBucketKeepAliveDays = 0\n# optional\nLoadReplicateTimeout = 0\n# optional\nLoadSealTimeout = 0\n\n[Task]\n# optional\nUploadTaskSpeed = 0\n# optional\nDownloadTaskSpeed = 0\n# optional\nReplicateTaskSpeed = 0\n# optional\nReceiveTaskSpeed = 0\n# optional\nSealObjectTaskTimeout = 0\n# optional\nGcObjectTaskTimeout = 0\n# optional\nGcZombieTaskTimeout = 0\n# optional\nGcMetaTaskTimeout = 0\n# optional\nSealObjectTaskRetry = 0\n# optional\nReplicateTaskRetry = 0\n# optional\nReceiveConfirmTaskRetry = 0\n# optional\nGcObjectTaskRetry = 0\n# optional\nGcZombieTaskRetry = 0\n# optional\nGcMetaTaskRetry = 0\n\n[Monitor]\n# required\nDisableMetrics = false\n# required\nDisablePProf = false\n# required\nMetricsHTTPAddress = ''\n# required\nPProfHTTPAddress = ''\n\n[Rcmgr]\n# optional\nDisableRcmgr = false\n\n[Log]\n# optional\nLevel = ''\n# optional\nPath = ''\n\n[Metadata]\n# required\nIsMasterDB = false\n# optional\nBsDBSwitchCheckIntervalSec = 0\n\n[BlockSyncer]\n# required\nModules = []\n# required\nDsn = ''\n# optional\nDsnSwitched = ''\n# required\nWorkers = 0\n# optional\nEnableDualDB = false\n\n[APIRateLimiter]\n# optional\nPathPattern = []\n# optional\nHostPattern = []\n# optional\nAPILimits = []\n\n[APIRateLimiter.IPLimitCfg]\n# optional\nOn = false\n# optional\nRateLimit = 0\n# optional\nRatePeriod = ''\n\n[Manager]\n# optional\nEnableLoadTask = false\n# optional\nSubscribeSPExitEventIntervalSec = 0\n# optional\nSubscribeSwapOutExitEventIntervalSec = 0\n# optional\nSubscribeBucketMigrateEventIntervalSec = 0\n# optional\nGVGPreferSPList = []\n")),(0,t.kt)("h2",{id:"app-info"},"App info"),(0,t.kt)("p",null,"These fields are optional and they can."),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"GRPCAddress = '0.0.0.0:9333'\n")),(0,t.kt)("h2",{id:"database"},"Database"),(0,t.kt)("p",null,"To config ",(0,t.kt)("inlineCode",{parentName:"p"},"[SpDB]"),", ",(0,t.kt)("inlineCode",{parentName:"p"},"[BsDB]")," and ",(0,t.kt)("inlineCode",{parentName:"p"},"[BsDBBackup]"),", you have to input the ",(0,t.kt)("inlineCode",{parentName:"p"},"user name"),", ",(0,t.kt)("inlineCode",{parentName:"p"},"db password' and\n"),"db address' in these fields."),(0,t.kt)("h2",{id:"piecestore"},"PieceStore"),(0,t.kt)("p",null,"To config ",(0,t.kt)("inlineCode",{parentName:"p"},"[PieceStore]")," and ",(0,t.kt)("inlineCode",{parentName:"p"},"[PieceStore.Store]"),", you can read the details in this ",(0,t.kt)("a",{parentName:"p",href:"/greenfield-docs/docs/guide/storage-provider/run-book/piece-store"},"doc")),(0,t.kt)("h2",{id:"chain-info"},"Chain info"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"ChainID")," of testnet is ",(0,t.kt)("inlineCode",{parentName:"li"},"greenfield_5600-1"),"."),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"ChainAddress")," is RPC endpoint of testnet, you can find RPC info ",(0,t.kt)("a",{parentName:"li",href:"/greenfield-docs/docs/api/endpoints"},"here"))),(0,t.kt)("h2",{id:"spaccount"},"SpAccount"),(0,t.kt)("p",null,"These private keys are generated during wallet setup."),(0,t.kt)("h2",{id:"endpoint"},"Endpoint"),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"[Endpoint]")," specified the URL of different services."),(0,t.kt)("p",null,"For single-machine host (not recommended):"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"[Endpoint]\nApproverEndpoint = ''\nManagerEndpoint = ''\nDownloaderEndpoint = ''\nReceiverEndpoint = ''\nMetadataEndpoint = ''\nUploaderEndpoint = ''\nP2PEndpoint = ''\nSignerEndpoint = ''\nAuthenticatorEndpoint = ''\n")),(0,t.kt)("p",null,"For K8S cluster:"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"[Endpoint]\nApproverEndpoint = 'manager:9333'\nManagerEndpoint = 'manager:9333'\nDownloaderEndpoint = 'downloader:9333'\nReceiverEndpoint = 'receiver:9333'\nMetadataEndpoint = 'metadata:9333'\nUploaderEndpoint = 'uploader:9333'\nP2PEndpoint = 'p2p:9333'\nSignerEndpoint = 'signer:9333'\nAuthenticatorEndpoint = 'localhost:9333'\n")),(0,t.kt)("h2",{id:"p2p"},"P2P"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},(0,t.kt)("inlineCode",{parentName:"p"},"P2PPrivateKey")," and ",(0,t.kt)("inlineCode",{parentName:"p"},"node_id")," is generated by ",(0,t.kt)("inlineCode",{parentName:"p"},"./gnfd-sp p2p.create.key -n 1"))),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},(0,t.kt)("inlineCode",{parentName:"p"},"P2PAntAddress")," is your load balance address. If you don't have a load balance address, you should have a public IP and use it in ",(0,t.kt)("inlineCode",{parentName:"p"},"P2PAddress"),". It consists of ",(0,t.kt)("inlineCode",{parentName:"p"},"ip:port"),".")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("p",{parentName:"li"},(0,t.kt)("inlineCode",{parentName:"p"},"P2PBootstrap")," can be left empty."))),(0,t.kt)("h2",{id:"gateway"},"Gateway"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"[Gateway]\nDomainName = 'region.sp-name.com'\n")),(0,t.kt)("p",null,"The correct configuration should not include the protocol prefix ",(0,t.kt)("inlineCode",{parentName:"p"},"https://"),"."),(0,t.kt)("h2",{id:"blocksyncer"},"BlockSyncer"),(0,t.kt)("p",null,"Here is how you put ",(0,t.kt)("inlineCode",{parentName:"p"},"Dsn")," config for ",(0,t.kt)("inlineCode",{parentName:"p"},"[BlockSyncer]")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre"},"Modules = ['epoch','bucket','object','payment','group','permission','storage_provider','prefix_tree', 'virtual_group','sp_exit_events','object_id_map']\nDsn = \"user:passwd*@tcp(localhost:3306)/block_syncer?parseTime=true&multiStatements=true&loc=Local&interpolateParams=true\"\nDsnSwitched = ''\nWorkers = 50\nEnableDualDB = false\n")))}u.isMDXComponent=!0}}]);