"use strict";(self.webpackChunkgreenfield_docs=self.webpackChunkgreenfield_docs||[]).push([[6650],{81212:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>d,contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>r,toc:()=>s});var n=i(87462),a=(i(67294),i(3905));const o={title:"Gateway"},l="Gateway",r={unversionedId:"guide/storage-provider/modules/gateway",id:"guide/storage-provider/modules/gateway",title:"Gateway",description:"The Gateway service serves as the unified entrance of HTTP requests for SP, providing a standardized HTTP RESTful API for application programming.",source:"@site/docs/guide/storage-provider/modules/gateway.md",sourceDirName:"guide/storage-provider/modules",slug:"/guide/storage-provider/modules/gateway",permalink:"/greenfield-docs/docs/guide/storage-provider/modules/gateway",draft:!1,editUrl:"https://github.com/bnb-chain/greenfield-docs/blob/main/docs/guide/storage-provider/modules/gateway.md",tags:[],version:"current",frontMatter:{title:"Gateway"},sidebar:"guideSidebar",previous:{title:"The Greenfield Storage Provider Standard",permalink:"/greenfield-docs/docs/guide/storage-provider/introduction/standard"},next:{title:"Approver",permalink:"/greenfield-docs/docs/guide/storage-provider/modules/approver"}},d={},s=[{value:"Overview",id:"overview",level:2},{value:"Authorization Checker",id:"authorization-checker",level:3},{value:"Request Router",id:"request-router",level:3},{value:"Flow Control",id:"flow-control",level:3},{value:"Load Balancer(LB)",id:"load-balancerlb",level:3},{value:"Middleware",id:"middleware",level:3},{value:"Universal Endpoint",id:"universal-endpoint",level:3},{value:"Download File",id:"download-file",level:4},{value:"View File",id:"view-file",level:4},{value:"Public File Access",id:"public-file-access",level:4},{value:"Private File Access",id:"private-file-access",level:4}],c={toc:s},p="wrapper";function u(e){let{components:t,...o}=e;return(0,a.kt)(p,(0,n.Z)({},c,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"gateway"},"Gateway"),(0,a.kt)("p",null,"The Gateway service serves as the unified entrance of HTTP requests for SP, providing a standardized ",(0,a.kt)("inlineCode",{parentName:"p"},"HTTP RESTful API")," for application programming.\nIf you are interested in the HTTP Restful API, we invite you to the ",(0,a.kt)("a",{parentName:"p",href:"/greenfield-docs/docs/api/storgae-provider-rest/"},"following page"),"."),(0,a.kt)("h2",{id:"overview"},"Overview"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"gateway-flow",src:i(25049).Z,width:"944",height:"662"})),(0,a.kt)("div",{style:{textAlign:"center"}},(0,a.kt)("i",null,"Gateway Architecture")),(0,a.kt)("h3",{id:"authorization-checker"},"Authorization Checker"),(0,a.kt)("p",null,"Gateway provides unified authorization for each HTTP request from the fowllowing three aspects:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Verifies the signature of request to ensure that the request has not been tampered with."),(0,a.kt)("li",{parentName:"ul"},"Checks the authorization to ensure the corresponding account has permissions on resources."),(0,a.kt)("li",{parentName:"ul"},"Checks the object state and payment account state to ensure the object is sealed and the payment account is active.")),(0,a.kt)("h3",{id:"request-router"},"Request Router"),(0,a.kt)("p",null,"Based on the specific request type, it is routed to the corresponding backend microservice."),(0,a.kt)("h3",{id:"flow-control"},"Flow Control"),(0,a.kt)("p",null,"Based on the flow control configuration policies, flow control will be performed to provide higher-quality services and avoid service overload."),(0,a.kt)("h3",{id:"load-balancerlb"},"Load Balancer(LB)"),(0,a.kt)("p",null,"In the future, when routing traffic to backend microservices in SP, SP Gateway would use LB to do this. LB is a method of distributing API request traffic across multiple upstream services. LB improves overall system responsiveness and reduces failures by preventing overloading of individual resources."),(0,a.kt)("h3",{id:"middleware"},"Middleware"),(0,a.kt)("p",null,"SP Gateway uses middleware to collect metrics, logging, register metadata and so on."),(0,a.kt)("h3",{id:"universal-endpoint"},"Universal Endpoint"),(0,a.kt)("p",null,"We implement the Universal Endpoint according to ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/bnb-chain/greenfield-whitepaper/blob/main/part3.md#231-universal-endpoint"},"Greenfield Whitepaper Universal Endpoint"),"."),(0,a.kt)("p",null,"All objects can be identified and accessed via a universal path: gnfd://<bucket_name><object_name>?","[parameter]","*"),(0,a.kt)("p",null,"Explanation:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"The beginning identifier ",(0,a.kt)("inlineCode",{parentName:"li"},"gnfd://")," is mandatory and cannot be changed.."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"bucket_name")," is the bucket name of the object and is mandatory."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"object_name")," is the name of the object and is mandatory."),(0,a.kt)("li",{parentName:"ul"},"The parameter is an optional list of key-value pairs that provide additional information for the URI.")),(0,a.kt)("p",null,'Each SP will register multiple endpoints to access their services, e.g. "SP1" may ask their users to download objects via ',(0,a.kt)("inlineCode",{parentName:"p"},"https://gnfd-testnet-sp-1.bnbchain.org/download"),".\nAnd the full download RESTful API would be like: ",(0,a.kt)("inlineCode",{parentName:"p"},"https://gnfd-testnet-sp-1.bnbchain.org/download/mybucket/myobject.jpg"),"."),(0,a.kt)("p",null,"Universal Endpoint supports using any valid endpoint for any SP, and automatically redirects to the correct endpoint containing the object for downloading."),(0,a.kt)("p",null,"For instance, when users access a testnet endpoint ",(0,a.kt)("inlineCode",{parentName:"p"},"gnfd-testnet-sp-1.bnbchain.org")," of SP1, the request URL will be: ",(0,a.kt)("inlineCode",{parentName:"p"},"https://gnfd-testnet-sp-1.bnbchain.org/download/mybucket/myobject.jpg"),". Universal Endpoint will find the correct endpoint for myobject.jpg, here SP3, and redirect the user to: ",(0,a.kt)("inlineCode",{parentName:"p"},"https://gnfd-testnet-sp-3.bnbchain.org/download/mybucket/myobject.jpg")," and download the file."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"gattway-universal-endpoint-flow",src:i(27179).Z,width:"556",height:"461"})),(0,a.kt)("div",{style:{textAlign:"center"}},(0,a.kt)("i",null,"Universal Endpoint Logic Flow")),(0,a.kt)("h4",{id:"download-file"},"Download File"),(0,a.kt)("p",null,"If you want to download a file using Universal Endpoint, downloading URL is like: ",(0,a.kt)("inlineCode",{parentName:"p"},"https://gnfd-testnet-sp-1.bnbchain.org/download/mybucket/myobject.jpg"),". This is enforced by adding this Content-Type to HTTP headers:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text"},"Content-Disposition=attachment\n")),(0,a.kt)("h4",{id:"view-file"},"View File"),(0,a.kt)("p",null,"If you want to view a file using Universal Endpoint, viewing url is like: ",(0,a.kt)("inlineCode",{parentName:"p"},"https://gnfd-testnet-sp-1.bnbchain.org/view/mybucket/myobject.jpg"),". This is enforced by adding this Content-Type to HTTP headers:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-text"},"Content-Disposition=inline\n")),(0,a.kt)("h4",{id:"public-file-access"},"Public File Access"),(0,a.kt)("p",null,"Public files can be downloaded/viewed with the following points to notice:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Downloader/Viewer's quota will not be deducted, but the object owner's quota will be deducted per ",(0,a.kt)("inlineCode",{parentName:"li"},"download or view"),"."),(0,a.kt)("li",{parentName:"ol"},"If a file's public or private status is not specified, its accessibility as a public or private file is determined by the status of the bucket it resides in, and whether it can be downloaded or viewed."),(0,a.kt)("li",{parentName:"ol"},"If a file is not sealed, it cannot be ",(0,a.kt)("inlineCode",{parentName:"li"},"downloaded or viewed"),".")),(0,a.kt)("h4",{id:"private-file-access"},"Private File Access"),(0,a.kt)("p",null,"Access private file is in design and will be provided in the new few releases. Currently, if you try to download or view a private file, an error will be thrown to let you know the object key you are using is illegal."))}u.isMDXComponent=!0},25049:(e,t,i)=>{i.d(t,{Z:()=>n});const n=i.p+"assets/images/06-gateway-f8c844c9ede2fc4e0d22085daf258950.jpg"},27179:(e,t,i)=>{i.d(t,{Z:()=>n});const n=i.p+"assets/images/501-SP-Gateway-Universal-Endpoint-55c84f274d8c6fb2a0db778399552c25.png"}}]);